version: '3.1'

services:
  history:
    image: history
    #hostname: aspace.library.albany.edu
    #network_mode: "host"
    container_name: history
    build: .
    ports:
      - '0.0.0.0:8081:3000'
    volumes:
      - ./log:/app/log
      - ./db/production.sqlite:/app/db/production.sqlite
    tty: true
    stdin_open: true
    environment:
      - RAILS_ENV=production
      - WEB_CONCURRENCY=2
      - RAILS_MAX_THREADS=5
    entrypoint: /bin/sh -c "bundle exec rails server -b 0.0.0.0"
    
